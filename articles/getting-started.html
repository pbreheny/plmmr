<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Getting started with plmmr • plmmr</title>
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Getting started with plmmr">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plmmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Start here - getting to know plmmr</a></li>
    <li><a class="dropdown-item" href="../articles/matrix_data.html">If your data is a matrix or data frame</a></li>
    <li><a class="dropdown-item" href="../articles/plink_files.html">If your data is in PLINK files</a></li>
    <li><a class="dropdown-item" href="../articles/delim_files.html">If your data is in (a) delimited file(s)</a></li>
    <li><a class="dropdown-item" href="../articles/notation.html">Notes on notation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/plmmr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Getting started with plmmr</h1>
                        <h4 data-toc-skip class="author">Tabitha
Peter</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/plmmr/blob/master/vignettes/getting-started.Rmd" class="external-link"><code>vignettes/getting-started.Rmd</code></a></small>
      <div class="d-none name"><code>getting-started.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pbreheny.github.io/plmmr/">plmmr</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: bigalgebra</span></span>
<span><span class="co">#&gt; Loading required package: bigmemory</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><code>plmmr</code> is a package for fitting
<strong>P</strong>enalized <strong>L</strong>inear
<strong>M</strong>ixed <strong>M</strong>odels in <strong>R</strong>.
This package was created for the purpose of fitting penalized regression
models to high dimensional data in which the observations are
correlated. For instance, this kind of data arises often in the context
of genetics (<em>e.g.</em>, GWAS in which there is population structure
and/or family grouping).</p>
<p>The novelties of <code>plmmr</code> are:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Integration</strong>: <code>plmmr</code> combines the
functionality of several packages in order to do quality control, model
fitting/analysis, and data visualization all in one package. For
example, if you have GWAS data, <code>plmmr</code> will take you from
PLINK files all the way to a list of SNPs for downstream
analysis.</p></li>
<li><p><strong>Accessibility</strong>: <code>plmmr</code> can be run
from an <code>R</code> session on a typical desktop or laptop computer.
The user does not need access to a supercomputer or have experience with
the command line in order to fit models <code>plmmr</code>.</p></li>
<li><p><strong>Handling correlation</strong>: <code>plmmr</code> uses a
transformation that (1) measures correlation among samples and (2) uses
this correlation measurement to improve predictions (via the best linear
unbiased predictor, or BLUP). This means that in <code><a href="../reference/plmm.html">plmm()</a></code>,
there’s no need to filter data down to a ‘maximum subset of unrelated
samples.’</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="minimal-example">Minimal example<a class="anchor" aria-label="anchor" href="#minimal-example"></a>
</h2>
<p>Below is a minimal reproducible example of how <code>plmmr</code> can
be used:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># library(plmmr)</span></span>
<span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plmm.html">plmm</a></span><span class="op">(</span><span class="va">admix</span><span class="op">$</span><span class="va">X</span>, <span class="va">admix</span><span class="op">$</span><span class="va">y</span><span class="op">)</span> <span class="co"># admix data ships with package</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">cvfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cv_plmm.html">cv_plmm</a></span><span class="op">(</span><span class="va">admix</span><span class="op">$</span><span class="va">X</span>, <span class="va">admix</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span></code></pre></div>
<p><img src="getting-started_files/figure-html/unnamed-chunk-2-2.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">cvfit</span><span class="op">)</span></span>
<span><span class="co">#&gt; lasso-penalized model with n=197 and p=101</span></span>
<span><span class="co">#&gt; At minimum cross-validation error (lambda=0.2325):</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt;   Nonzero coefficients: 8</span></span>
<span><span class="co">#&gt;   Cross-validation error (deviance): 2.12</span></span>
<span><span class="co">#&gt;   Scale estimate (sigma): 1.455</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="computational-capability">Computational capability<a class="anchor" aria-label="anchor" href="#computational-capability"></a>
</h2>
<div class="section level3">
<h3 id="file-backing">File-backing<a class="anchor" aria-label="anchor" href="#file-backing"></a>
</h3>
<p>In many applications of high dimensional data analysis, the dataset
is too large to read into R – the session will crash for lack of memory.
This is particularly common when analyzing data from genome-wide
association studies (GWAS). To analyze such large datasets,
<code>plmmr</code> is equipped to analyze data using
<em>filebacking</em> - a strategy that lets R ‘point’ to a file on disk,
rather than reading the file into the R session. Many other packages use
this technique - <a href="https://privefl.github.io/bigstatsr/" class="external-link">bigstatsr</a> and <a href="https://pbreheny.github.io/biglasso/" class="external-link">biglasso</a> are two
examples of packages that use the filebacking technique. The package
that <code>plmmr</code> uses to create and store filebacked objects is
<a href="https://CRAN.R-project.org/package=bigmemory" class="external-link">bigmemory</a>.
The filebacked computation relies on the <a href="https://pbreheny.github.io/biglasso/" class="external-link">biglasso</a> package by <a href="https://scholar.google.com/citations?user=jpEmf04AAAAJ&amp;hl=en" class="external-link">Yaohui
Zeng</a> et al. and on <a href="https://CRAN.R-project.org/package=bigalgebra" class="external-link">bigalgebra</a> by
Michael Kane et al. For processing <a href="https://www.cog-genomics.org/plink/" class="external-link">PLINK</a> files, we use
methods from the <code>bigsnpr</code> <a href="https://privefl.github.io/bigsnpr/" class="external-link">package</a> by <a href="https://privefl.github.io/" class="external-link">Florian Privé</a>.</p>
</div>
<div class="section level3">
<h3 id="numeric-outcomes-only">Numeric outcomes only<a class="anchor" aria-label="anchor" href="#numeric-outcomes-only"></a>
</h3>
<p>At this time, the package is designed for linear regression only –
that is, we are considering only continuous (numeric) outcomes. We
maintain that treating binary outcomes as numeric values is appropriate
in some contexts, as described by Hastie et al. in the <a href="https://hastie.su.domains/ElemStatLearn/" class="external-link">Elements of Statistical
Learning</a>, chapter 4. In the future, we would like to extend this
package to handle dichotomous outcomes via logistic regression; the
theoretical work underlying this is an open problem.</p>
</div>
<div class="section level3">
<h3 id="types-of-penalization">3 types of penalization<a class="anchor" aria-label="anchor" href="#types-of-penalization"></a>
</h3>
<p>Since we are focused on penalized regression in this package,
<code>plmmr</code> offers 3 choices of penalty: the minimax concave
(MCP), the smoothly clipped absolute deviation (SCAD), and the least
absolute shrinkage and selection operator (LASSO). The implementation of
these penalties is built on the concepts/techniques provided in the <a href="https://pbreheny.github.io/ncvreg/" class="external-link">ncvreg</a> package.</p>
</div>
<div class="section level3">
<h3 id="data-size-and-dimensionality">Data size and dimensionality<a class="anchor" aria-label="anchor" href="#data-size-and-dimensionality"></a>
</h3>
<p>We distinguish between the data attributes ‘big’ and ‘high
dimensional.’ ‘Big’ describes the amount of space data takes up on a
computer, while ‘high dimensional’ describes a context where the ratio
of features (also called ‘variables’ or ‘predictors’) to observations
(e.g., samples) is high. For instance, data with 100 samples and 100
variables is high dimensional, but not big. By contrast, data with 10
million observations and 100 variables is big, but not high
dimensional.</p>
<p><code>plmmr</code> is optimized for data that are high dimensional –
the methods we are using to estimate relatedness among observations
perform best when there are a high number of features relative to the
number of observations.</p>
<p><code>plmmr</code> is also designed to accommodate data that is too
large to analyze in-memory. We accommodate such data through
file-backing (as described above). Our current analysis pipeline works
well for data files up to about 40 Gb in size. In practice, this means
that <code>plmmr</code> is equipped to analyze GWAS data, but not
biobank-sized data.</p>
</div>
</div>
<div class="section level2">
<h2 id="data-input-types">Data input types<a class="anchor" aria-label="anchor" href="#data-input-types"></a>
</h2>
<p><code>plmmr</code> currently works with three types of data
input:</p>
<ol style="list-style-type: decimal">
<li><p>Data that is stored in-memory as a matrix or data frame</p></li>
<li><p>Data that is stored in PLINK files</p></li>
<li><p>Data that is stored in delimited files</p></li>
</ol>
<div class="section level3">
<h3 id="example-data-sets">Example data sets<a class="anchor" aria-label="anchor" href="#example-data-sets"></a>
</h3>
<p><code>plmmr</code> currently includes three example data sets, one
for each type of data input.</p>
<ul>
<li><p>The <code>admix</code> data is our example of matrix input data.
<code>admix</code> is a small data set (197 observations, 100 SNPs) that
describes individuals of different ancestry groups. The outcome of
<code>admix</code> is simulated to include population structure effects
(<em>i.e.</em> race/ethnicity have an impact on the SNP associations).
This data set is available as whenever <code><a href="https://pbreheny.github.io/plmmr/">library(plmmr)</a></code> is
called. An example analysis with the <code>admix</code> data is
available in
<code>vignette('matrix_data', package = "plmmr")</code>.</p></li>
<li><p>The <code>penncath_lite</code> data is our example of PLINK input
data. <code>penncath_lite</code> (data on coronary artery disease from
the <a href="https://pubmed.ncbi.nlm.nih.gov/21239051/" class="external-link">PennCath
study</a>) is a high dimensional data set (1401 observations, 4217 SNPs)
with several health outcomes as well as age and sex information. The
features in this data set represent a small subset of a much larger GWAS
data set (the original data has over 800K SNPs). For for information on
this data set, refer to the <a href="https://pubmed.ncbi.nlm.nih.gov/21239051/" class="external-link">original
publication</a>. An example analysis with the <code>penncath_lite</code>
data is available in
<code>vignette('plink_files', package = "plmmr")</code>.</p></li>
<li><p>The <code>colon2</code> data is our example of delimited-file
input data. <code>colon2</code> is a variation of the <code>colon</code>
data included in the <a href="https://pbreheny.github.io/biglasso/" class="external-link">biglasso</a> package.
<code>colon2</code> has 62 observations and 2,001 features representing
a study of colon disease. 2000 features are original to the data, and
the ‘sex’ feature is simulated. An example analysis with the
<code>colon2</code> data is available in
<code>vignette('delim_files', package = "plmmr")</code>.</p></li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tabitha K. Peter, Anna C. Reisetter, Patrick J. Breheny, Yujing Lu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
