<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Notes on notation • plmmr</title>
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Notes on notation">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">plmmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">4.1.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/getting-started.html">Start here - getting to know plmmr</a></li>
    <li><a class="dropdown-item" href="../articles/matrix_data.html">If your data is a matrix or data frame</a></li>
    <li><a class="dropdown-item" href="../articles/plink_files.html">If your data is in PLINK files</a></li>
    <li><a class="dropdown-item" href="../articles/delim_files.html">If your data is in (a) delimited file(s)</a></li>
    <li><a class="dropdown-item" href="../articles/notation.html">Notes on notation</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pbreheny/plmmr"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Notes on notation</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/pbreheny/plmmr/blob/master/vignettes/articles/notation.Rmd" class="external-link"><code>vignettes/articles/notation.Rmd</code></a></small>
      <div class="d-none name"><code>notation.Rmd</code></div>
    </div>

    
    
<p>The purpose of this short vignette is to document the notation
conventions for the math and programming related to PLMM. We begin with
the math, and then translate our math notation into naming objects in
our source code.</p>
<p>Throughout this document, the reader will notice some notation
conventions:</p>
<ul>
<li>Matrices are denoted with <strong>boldface</strong>, UPPERCASE
letters</li>
<li>Vectors are denoted with <strong>boldface</strong> lowercase
letters</li>
<li>Scalar values and indices are denoted with lowercase letters</li>
<li>the <span class="math inline">\dot{}</span> modifier indicates
(column) standardization</li>
<li>the <span class="math inline">\tilde{}</span> modifier indicates
rotation</li>
</ul>
<div class="section level2">
<h2 id="math-notation">Math notation<a class="anchor" aria-label="anchor" href="#math-notation"></a>
</h2>
<p>Here are the concepts we need to denote, in order of their usage in
our derivations. I have blocked these into sections corresponding to the
steps of the model fitting process.</p>
<div class="section level3">
<h3 id="statistical-model-the-overall-framework">Statistical model (the overall framework)<a class="anchor" aria-label="anchor" href="#statistical-model-the-overall-framework"></a>
</h3>
<p>The overall model can be written as</p>
<p><span class="math display">
\mathbf{y} = \mathbf{X}\boldsymbol{\beta} +
\mathbf{Z}\boldsymbol{\gamma} + \boldsymbol{\epsilon}
</span></p>
<p>or equivalently as <span class="math display">
\mathbf{y} = \dot{\mathbf{X}}\dot{\boldsymbol{\beta}} + \mathbf{u} +
\boldsymbol{\epsilon}
</span> where:</p>
<ul>
<li><p><span class="math inline">\mathbf{X}</span> and <span class="math inline">\mathbf{y}</span> are the <span class="math inline">n \times p</span> design matrix of our data and the
<span class="math inline">n \times 1</span> vector of outcomes,
respectively. Here, <span class="math inline">n</span> is the number of
<em>observations</em> (e.g., number of patients, number of samples,
etc.) and <span class="math inline">p</span> is the number of
<em>features</em> (e.g., number of SNPs, number of variables, number of
covariates, etc.).</p></li>
<li><p><span class="math inline">\dot{\mathbf{X}}</span> is the
column-standardized <span class="math inline">\mathbf{X}</span>, in
which each of the <span class="math inline">p</span> columns has mean 0
and standard deviation 1. Note: <span class="math inline">\dot{\mathbf{X}}</span> excludes any singular
features (columns of constants) in the original <span class="math inline">\mathbf{X}</span>.</p></li>
<li><p><span class="math inline">\dot{\boldsymbol{\beta}}</span>
represents the coefficients on the standardized scale.</p></li>
<li><p><span class="math inline">\mathbf{Z}</span> is a <span class="math inline">n \times b</span> matrix of indicators corresponding
to a grouping structure, and <span class="math inline">\boldsymbol{\gamma}</span> is the vector of values
describing how each grouping is associated with <span class="math inline">\mathbf{y}</span>. In real data, these values
typically unknown.</p></li>
<li><p><span class="math inline">\boldsymbol{\epsilon}</span> is the
<span class="math inline">n \times 1</span> vector of noise.</p></li>
</ul>
<p>We define the realized (or empirical) relatedness matrix as <span class="math inline">\mathbf{K} \equiv
\frac{1}{p}\dot{\mathbf{X}}\dot{\mathbf{X}}^\top</span></p>
<p>This model assumes:</p>
<ul>
<li><span class="math inline">\boldsymbol{\epsilon} \perp
\mathbf{u}</span></li>
<li><span class="math inline">\boldsymbol{\epsilon} \sim N(0,
\sigma^2_{\epsilon}\mathbf{I})</span></li>
<li><span class="math inline">\mathbf{u} \sim N(0,
\sigma^2_{s}\mathbf{K})</span></li>
</ul>
<p>Under these assumptions, we may write <span class="math inline">\mathbf{y} \sim
N(\dot{\mathbf{X}}\dot{\boldsymbol{\beta}},
\boldsymbol{\Sigma})</span></p>
<p><strong>Indices</strong>:</p>
<ul>
<li>
<span class="math inline">i \in 1,..., n</span> indexes
observations</li>
<li>
<span class="math inline">j \in 1,..., p</span> indexes
features</li>
<li>
<span class="math inline">h \in 1,..., b</span> indexes the batches
(e.g., different family groups, different data collection sites,
etc.)</li>
</ul>
</div>
<div class="section level3">
<h3 id="decomposition-and-rotation-prep-and-first-part-of-fit">Decomposition and rotation (prep and first part of fit)<a class="anchor" aria-label="anchor" href="#decomposition-and-rotation-prep-and-first-part-of-fit"></a>
</h3>
<ul>
<li><p>Beginning with an eigendecomposition, we have <span class="math inline">\mathbf{U}</span> and <span class="math inline">\mathbf{s}</span> are the eigenvectors and
eigenvalues of <span class="math inline">\mathbf{K}</span>, as one would
obtain from <span class="math inline">\text{eigen}(\mathbf{K)} \equiv
\mathbf{U}\mathbf{S}\mathbf{U}^\top</span>. The elements of <span class="math inline">\mathbf{s}</span> are the diagonal values of <span class="math inline">\mathbf{S}</span>. Note, random effect <span class="math inline">\mathbf{u}</span> is distinct from the columns of
matrix <span class="math inline">\mathbf{U}</span>.</p></li>
<li><p><span class="math inline">k</span> represents the number of
nonzero eigenvalues represented in <span class="math inline">\mathbf{U}</span> and <span class="math inline">\mathbf{d}</span>, so <span class="math inline">k
\leq \text{min}(n,p)</span>.</p></li>
<li><p>Again, <span class="math inline">\mathbf{K} \equiv
\frac{1}{p}\dot{\mathbf{X}}\dot{\mathbf{X}}^{\top}</span> is often
referred to in the literature as the realized relatedness matrix (RRM)
or genomic relatedness matrix (GRM). <span class="math inline">\mathbf{K}</span> has dimension <span class="math inline">n \times n</span>.</p></li>
<li><p><span class="math inline">\eta</span> is the ratio <span class="math inline">\frac{\sigma^2_s}{\sigma^2_e + \sigma^2_s}</span>.
We estimate <span class="math inline">\hat{\eta}</span> from a null
model (more details to come).</p></li>
<li><p><span class="math inline">\mathbf{\Sigma}</span> is the variance
of the outcome, where <span class="math inline">\mathbb{V}({\mathbf{y}})
\propto \eta \mathbf{K} + (1 - \eta)\mathbf{I}_n</span>.</p></li>
<li><p><span class="math inline">\mathbf{w}</span> is the vector of
weights defined as <span class="math inline">(\eta\mathbf{\mathbf{s}} +
(1-\eta))^{-1/2}</span>. The values in <span class="math inline">\mathbf{w}</span> are the nonzero values of the
diagonal matrix <span class="math inline">\mathbf{W} \equiv
(\eta\mathbf{S} + (1 - \eta)\mathbf{I})^{-1/2}</span>.</p></li>
<li><p>The matrix to be used in rotating (or <em>preconditioning</em>)
the data is <span class="math inline">\mathbf{\Sigma}^{-1/2} \equiv
\mathbf{W}\mathbf{U}^\top</span>.</p></li>
<li><p><span class="math inline">\tilde{\dot{\mathbf{X}}} \equiv
\mathbf{W}\mathbf{U}^\top\dot{\mathbf{X}}</span> is the rotated data, or
the data on the transformed scale.</p></li>
<li><p><span class="math inline">\tilde{\mathbf{y}} \equiv
\mathbf{\Sigma}^{-1/2}\mathbf{y}</span> is the outcome on the rotated
scale.</p></li>
<li><p><span class="math inline">\tilde{\ddot{\mathbf{X}}}</span> is the
<strong>standardized</strong> rotated data. Note: This standardization
involves scaling, but not centering. This post-rotation standardization
impacts the estimated coefficients as well; we define <span class="math inline">{\ddot{\boldsymbol{\beta}}}</span> as the estimated
coefficients on this scale.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="model-fitting-with-penalization">Model fitting with penalization<a class="anchor" aria-label="anchor" href="#model-fitting-with-penalization"></a>
</h3>
<p>We fit <span class="math inline">\tilde{\mathbf{y}} \sim
\tilde{\ddot{\mathbf{X}}}</span> using a penalized linear mixed model,
and obtain <span class="math inline">\hat{\ddot{\boldsymbol{\beta}}}</span> as our
estimated coefficients. The penalty parameter values (e.g., values of
the lasso tuning parameter) are indexed by <span class="math inline">\lambda_l \in 1,..., t</span>.</p>
</div>
<div class="section level3">
<h3 id="rescaling-results-format">Rescaling results (format)<a class="anchor" aria-label="anchor" href="#rescaling-results-format"></a>
</h3>
<p>To obtain the estimated coefficients on the original scale, the
values estimated by the model must be unscaled (or ‘untransformed’)
twice: once to adjust for the post-rotation standardization, and again
to adjust for the pre-rotation standardization. This process could be
written <span class="math inline">\hat{\ddot{\boldsymbol{\beta}}}
\rightarrow \hat{\dot{\boldsymbol{\beta}}} \rightarrow
\hat{\boldsymbol{\beta}}</span>.</p>
</div>
</div>
<div class="section level2">
<h2 id="object-names-in-source-code">Object names in source code<a class="anchor" aria-label="anchor" href="#object-names-in-source-code"></a>
</h2>
<p>In the code, we denote the objects above in this way:</p>
<ul>
<li><p><span class="math inline">\mathbf{X}</span> and <span class="math inline">\mathbf{y}</span> are <code>X</code> and
<code>y</code></p></li>
<li><p><span class="math inline">\dot{\mathbf{X}}</span> is
<code>std_X</code></p></li>
<li><p><span class="math inline">\tilde{\dot{\mathbf{X}}}</span> is
<code>rot_X</code></p></li>
<li><p><span class="math inline">\ddot{\tilde{\mathbf{X}}}</span> is
<code>stdrot_X</code></p></li>
<li><p><span class="math inline">\hat{\boldsymbol{\beta}}</span> is
named <code>og_scale_beta</code> in helper functions (for clarity) and
returned in <code>plmm</code> objects as <code>beta_vals</code>.
<code>beta_vals</code> and <code>og_scale_beta</code> are equivalent;
both represent the estimated coefficients on the original
scale.</p></li>
<li><p><span class="math inline">\hat{\dot{\boldsymbol{\beta}}}</span>
is <code>std_scale_beta</code></p></li>
<li><p><span class="math inline">\hat{\ddot{\boldsymbol{\beta}}}</span>
is <code>stdrot_scale_beta</code></p></li>
<li><p><span class="math inline">\dot{\mathbf{X}}\hat{\dot{\boldsymbol{\beta}}}</span>
is <code>Xb</code></p></li>
<li><p><span class="math inline">\ddot{\tilde{\mathbf{X}}}
\hat{\ddot{\boldsymbol{\beta}}}</span> is
<code>linear_predictors</code>. Note: in words, this means the
<code>linear_predictors</code> in the code are on the scale of the
rotated and re-standardized data!</p></li>
<li><p><span class="math inline">\hat{\boldsymbol{\Sigma}} \equiv
\hat{\eta}\mathbf{K} + (1 - \hat{\eta})\mathbf{I}</span> is
<code>estimated_Sigma</code>. Similarly, <span class="math inline">\hat{\boldsymbol{\Sigma}}_{11}</span> is
<code>Sigma_11</code>, etc.</p></li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tabitha K. Peter, Anna C. Reisetter, Patrick J. Breheny, Yujing Lu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
