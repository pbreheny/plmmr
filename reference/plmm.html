<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function allows you to fit a linear mixed model via non-convex penalized maximum likelihood.
NB: this function is simply a wrapper for plmm_prep -&amp;gt; plmm_fit -&amp;gt; plmm_format"><title>Fit a linear mixed model with non-convex regularization — plmm • plmmr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Fit a linear mixed model with non-convex regularization — plmm"><meta property="og:description" content="This function allows you to fit a linear mixed model via non-convex penalized maximum likelihood.
NB: this function is simply a wrapper for plmm_prep -&amp;gt; plmm_fit -&amp;gt; plmm_format"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">plmmr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/A-plink-files.html">Processing PLINK files</a>
    <a class="dropdown-item" href="../articles/B-choose_k.html">Choosing k -- an eigenproblem</a>
    <a class="dropdown-item" href="../articles/C-explore_options.html">Exploring different modeling options</a>
    <a class="dropdown-item" href="../articles/D-deconfounding.html">Deconfounding</a>
    <a class="dropdown-item" href="../articles/E-mfdr.html">Inference with marginal false discovery rates</a>
    <a class="dropdown-item" href="../articles/getting-started.html">Getting started with plmm</a>
    <a class="dropdown-item" href="../articles/notation.html">Notes on notation</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fit a linear mixed model with non-convex regularization</h1>
      
      <div class="d-none name"><code>plmm.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function allows you to fit a linear mixed model via non-convex penalized maximum likelihood.
NB: this function is simply a wrapper for plmm_prep -&gt; plmm_fit -&gt; plmm_format</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plmm</span><span class="op">(</span></span>
<span>  <span class="va">X</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  k <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  K <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  diag_K <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  eta_star <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  penalty <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MCP"</span>, <span class="st">"SCAD"</span>, <span class="st">"lasso"</span><span class="op">)</span>,</span>
<span>  <span class="va">gamma</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  <span class="va">lambda.min</span>,</span>
<span>  nlambda <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  <span class="va">lambda</span>,</span>
<span>  eps <span class="op">=</span> <span class="fl">1e-04</span>,</span>
<span>  max.iter <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>  convex <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  dfmax <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>  warn <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  penalty.factor <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  init <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  trace <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>X</dt>
<dd><p>Design matrix object or a string with the file path to a design matrix. If a string, string will be passed to <code><a href="get_data.html">get_data()</a></code>.</p><ul><li><p>Note: X may include clinical covariates and other non-SNP data, but no missing values are allowed.</p></li>
</ul></dd>


<dt>y</dt>
<dd><p>Continuous outcome vector. Logistic regression modeling is still in development.</p></dd>


<dt>k</dt>
<dd><p>An integer specifying the number of singular values to be used in the approximation of the rotated design matrix. This argument is passed to <code><a href="https://rdrr.io/pkg/RSpectra/man/svds.html" class="external-link">RSpectra::svds()</a></code>. Defaults to <code>min(n, p) - 1</code>, where n and p are the dimensions of the <em>standardized</em> design matrix.</p></dd>


<dt>K</dt>
<dd><p>Similarity matrix used to rotate the data. This should either be (1) a known matrix that reflects the covariance of y, (2) an estimate (Default is \(\frac{1}{p}(XX^T)\)), or (3) a list with components 'd' and 'u', as returned by choose_k().</p></dd>


<dt>diag_K</dt>
<dd><p>Logical: should K be a diagonal matrix? This would reflect observations that are unrelated, or that can be treated as unrelated. Defaults to FALSE.
Note: plmm() does not check to see if a matrix is diagonal. If you want to use a diagonal K matrix, you must set diag_K = TRUE.</p></dd>


<dt>eta_star</dt>
<dd><p>Optional argument to input a specific eta term rather than estimate it from the data. If K is a known covariance matrix that is full rank, this should be 1.</p></dd>


<dt>penalty</dt>
<dd><p>The penalty to be applied to the model. Either "MCP" (the default), "SCAD", or "lasso".</p></dd>


<dt>gamma</dt>
<dd><p>The tuning parameter of the MCP/SCAD penalty (see details). Default is 3 for MCP and 3.7 for Spenncath.</p></dd>


<dt>alpha</dt>
<dd><p>Tuning parameter for the Mnet estimator which controls the relative contributions from the MCP/Spenncath penalty and the ridge, or L2 penalty. alpha=1 is equivalent to MCP/Spenncath penalty, while alpha=0 would be equivalent to ridge regression. However, alpha=0 is not supported; alpha may be arbitrarily small, but not exactly 0.</p></dd>


<dt>lambda.min</dt>
<dd><p>The smallest value for lambda, as a fraction of lambda.max. Default is .001 if the number of observations is larger than the number of covariates and .05 otherwise.</p></dd>


<dt>nlambda</dt>
<dd><p>Length of the sequence of lambda. Default is 100.</p></dd>


<dt>lambda</dt>
<dd><p>A user-specified sequence of lambda values. By default, a sequence of values of length nlambda is computed, equally spaced on the log scale.</p></dd>


<dt>eps</dt>
<dd><p>Convergence threshold. The algorithm iterates until the RMSD for the change in linear predictors for each coefficient is less than eps. Default is <code>1e-4</code>.</p></dd>


<dt>max.iter</dt>
<dd><p>Maximum number of iterations (total across entire path). Default is 10000.</p></dd>


<dt>convex</dt>
<dd><p>Calculate index for which objective function ceases to be locally convex? Default is TRUE.</p></dd>


<dt>dfmax</dt>
<dd><p>Upper bound for the number of nonzero coefficients. Default is no upper bound. However, for large data sets, computational burden may be heavy for models with a large number of nonzero coefficients.</p></dd>


<dt>warn</dt>
<dd><p>Return warning messages for failures to converge and model saturation? Default is TRUE.</p></dd>


<dt>penalty.factor</dt>
<dd><p>A multiplicative factor for the penalty applied to each coefficient. If supplied, penalty.factor must be a numeric vector of length equal to the number of columns of X. The purpose of penalty.factor is to apply differential penalization if some coefficients are thought to be more likely than others to be in the model. In particular, penalty.factor can be 0, in which case the coefficient is always in the model without shrinkage.</p></dd>


<dt>init</dt>
<dd><p>Initial values for coefficients. Default is 0 for all columns of X.</p></dd>


<dt>trace</dt>
<dd><p>If set to TRUE, inform the user of progress by announcing the beginning of each step of the modeling process. Default is FALSE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list which includes:</p><ul><li><p><code>beta_vals</code>: the matrix of estimated coefficients on the original scale. Rows are predictors, columns are values of <code>lambda</code></p></li>
<li><p><code>rotated_scale_beta_vals</code>: the matrix of estimated coefficients on the ~rotated~ scale. This is the scale on which the model was fit.</p></li>
<li><p><code>lambda</code>: a numeric vector of the lasso tuning parameter values used in model fitting.</p></li>
<li><p><code>eta</code>: a number (double) between 0 and 1 representing the estimated proportion of the variance in the outcome attributable to population/correlation structure.</p></li>
<li><p><code>s</code>: a vectof of the eigenvalues of relatedness matrix <code>K</code>; see <code><a href="relatedness_mat.html">relatedness_mat()</a></code> for details.</p></li>
<li><p><code>U</code>: a matrix of the eigenvalues of relatedness matrix <code>K</code></p></li>
<li><p><code>rot_y</code>: the vector of outcome values on the rotated scale. This is the scale on which the model was fit.</p></li>
<li><p><code>linear.predictors</code>: the matrix resulting from the product of <code>stdrot_X</code> and the estimated coefficients on the ~rotated~ scale.</p></li>
<li><p><code>penalty</code>: character string indicating the penalty with which the model was fit (e.g., 'MCP')</p></li>
<li><p><code>gamma</code>: numeric value indicating the tuning parameter used for the SCAD or lasso penalties was used. Not relevant for lasso models.</p></li>
<li><p><code>alpha</code>: numeric value indicating the elastic net tuning parameter.</p></li>
<li><p><code>convex.min</code>: NULL (This is an option we will add in the future!)</p></li>
<li><p><code>loss</code>: vector with the numeric values of the loss at each value of <code>lambda</code> (calculated on the ~rotated~ scale)</p></li>
<li><p><code>penalty.factor</code>: vector of indicators corresponding to each predictor, where 1 = predictor was penalized.</p></li>
<li><p><code>ns_idx</code>: vector with the indicies of predictors which were constant features (i.e., had no variation).</p></li>
<li><p><code>p</code>: the number of features</p></li>
<li><p><code>n</code>: the number of observations (instances)</p></li>
<li><p><code>iter</code>: numeric vector with the number of iterations needed in model fitting for each value of <code>lambda</code></p></li>
<li><p><code>converged</code>: vector of logical values indicating whether the model fitting converged at each value of <code>lambda</code></p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># using admix data </span></span></span>
<span class="r-in"><span><span class="va">fit_admix1</span> <span class="op">&lt;-</span> <span class="fu">plmm</span><span class="op">(</span>X <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">X</span>, y <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_admix1</span>, idx <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">s1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MCP-penalized regression model with n=, p=101 at lambda=0.0316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The model converged </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # of non-zero coefficients:  82 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_admix1</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plmm-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># an example with p &gt; n:</span></span></span>
<span class="r-in"><span><span class="va">fit_admix2</span> <span class="op">&lt;-</span> <span class="fu">plmm</span><span class="op">(</span>X <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">X</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="op">]</span>, y <span class="op">=</span> <span class="va">admix</span><span class="op">$</span><span class="va">y</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_admix2</span>, idx <span class="op">=</span> <span class="fl">99</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">s2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MCP-penalized regression model with n=, p=101 at lambda=0.0402</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> The model converged </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> # of non-zero coefficients:  30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_admix2</span><span class="op">)</span> <span class="co"># notice: the default penalty is MCP</span></span></span>
<span class="r-plt img"><img src="plmm-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Anna C. Reisetter, Patrick J. Breheny, Tabitha K. Peter, Yujing Lu.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

